"use strict";(self.webpackChunkmellow_portfolio=self.webpackChunkmellow_portfolio||[]).push([[235],{9472:function(e,a,n){var t=n(7294);a.Z=function(e){var a=e.scrollToTop,n=void 0===a?function(){window.scrollTo({top:0,behavior:"smooth"})}:a,s=t.useState("scroll-to-top"),o=s[0],c=s[1];return t.useEffect((function(){window.addEventListener("scroll",(function(){window.scrollY>innerHeight?c("scroll-to-top in"):c("scroll-to-top")}))}),[]),t.createElement("div",{className:o,onClick:n})}},2729:function(e,a,n){n.r(a),n.d(a,{default:function(){return i}});var t=n(7294),s=n(3366),o=n(4983),c=["components"],p={_frontmatter:{}};function m(e){var a=e.components,n=(0,s.Z)(e,c);return(0,o.kt)("wrapper",Object.assign({},p,n,{components:a,mdxType:"MDXLayout"}),(0,o.kt)("h2",null,"Autogenerate Outlook signatures"),(0,o.kt)("p",null,"This script will generate signatures in Outlook based on a template .docx. It will log all signature updates to a single server, so you can track rollout and updates"),(0,o.kt)("p",null,"To use this script, you must place the template .docx file in the same location as the script (can be run from a GPO). Microsoft Word must be installed on the target machine, which should be the case if Outlook is installed."),(0,o.kt)("p",null,"Template replacement format is ","[","Title","]"," which will be replaced with the same value within Active Directory, eg. SharePoint Designer"),(0,o.kt)("div",{className:"gatsby-highlight","data-language":"powershell"},(0,o.kt)("pre",{parentName:"div",className:"language-powershell"},(0,o.kt)("code",{parentName:"pre",className:"language-powershell"},(0,o.kt)("span",{parentName:"code",className:"token comment"},"#!/usr/local/bin/pwsh"),"\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"<#\n    .SYNOPSIS\n    Script to set Outlook 2010/2013 e-mail signature using Active Directory information\n\n    .DESCRIPTION\n    This script will set the Outlook 2010/2013 e-mail signature on the local client using Active Directory information.\n    The template is created with a Word document, where images can be inserted and AD values can be provided.\n\n    Author: George Paton\n    Version 2.1\n#>"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"###  Global Vars ###"),"\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"## Company Variables"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$COMPANY_LONG_NAME"),"  = ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Upstream Production Solutions"'),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$COMPANY_SHORT_NAME")," = ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Upstream PS"'),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$COMPANY_INITIALS"),"   = ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"UPS"'),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$COMPANY_VAR_NAME"),"   = ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"upstreamps"'),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$COMPANY_EMAIL_EXT"),"  = ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"@UpstreamPS.com"'),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$COMPANY_EMAIL_ENC"),"  = ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"_upstreamps_com"'),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"### Logging Variables"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$LOG_FOLDER")," = ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"\\\\Log-Server\\Log-Share\\Logs\\"'),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_LOG_FOLDER")," = ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Set-Outlook-Signature\\"'),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"## Signature Variables"),"\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Signature name as it shows in Outlook"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_COMPOSE_NAME")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$COMPANY_VAR_NAME"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_REPLY_NAME"),"   = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$COMPANY_VAR_NAME")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"-reply"'),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Separate signatures for compose/reply emails"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_SEPARATE")," = ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$true"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Signature template filenames"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_COMPOSE_TEMPLATE")," = ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"template-compose.docx"'),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_REPLY_TEMPLATE"),"   = ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"template-reply.docx"'),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_FORCE"),"         = ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),"  ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"#Set to $true if you don't want the users to be able to change signature in Outlook"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_FORCE_THEME"),"   = ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$true"),"   ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"#Set to $true to force Outlook default message theme within registry - ONLY IN Office 2013"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_MARK_COMMENTS")," = ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$true"),"   ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"#Enable marking comments in emails with initials eg. [GP] - ONLY IN Office 2013"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Default email compose and reply styling"),"\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Colour is in BGR format, not RGB"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_COMPOSE_FONT"),"  = ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Calibri"'),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_COMPOSE_SIZE"),"  = 11\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_COMPOSE_COLOR")," = 0x5c3405\n\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_REPLY_FONT"),"    = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_COMPOSE_FONT"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_REPLY_SIZE"),"    = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_COMPOSE_SIZE"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_REPLY_COLOR"),"   = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_COMPOSE_COLOR"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Maximum amount of days to elapse before autorenewing signature"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_MAX_AGE"),"       = 60\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Specify which lines to remove from completed template to handle blank fields in AD"),"\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# This is an ARRAY LITERAL, please read:"),"\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# * http://blogs.msdn.com/b/powershell/archive/2007/01/23/array-literals-in-powershell.aspx"),"\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# ORDER MATTERS, Items higher up will be evaluated first"),"\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# ^? matches any character, in this case, a newline character (so if an entire line is removed,"),"\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# the newline is also removed, which ensures no weird blank lines show up)"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_TEMPLATE_BLANKS")," =\n    ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"a: [StreetAddress], [l] [st] [postalCode]^?"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"d: [TelephoneNumber] | r: [HomePhone] | m: [Mobile]^?"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"d: [TelephoneNumber] | r: [HomePhone] | "'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"| r: [HomePhone] | m: [Mobile]"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"| m: [Mobile]"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"d: [TelephoneNumber] | "'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"r: [HomePhone] | "'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"[l] "'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"[st] "'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"[postalCode]"'),"\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"### /Global Vars ###"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token operator"},"-not")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_SEPARATE"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_REPLY_NAME")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_COMPOSE_NAME"),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Stop execution on unhandled errors"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$ErrorActionPreference")," = ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Stop"'),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Environment variables"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$appData")," = ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token function"},"Get-Item")," env:appdata",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"value\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$signaturePath")," = ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"\\Microsoft\\Signatures"'),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$localSignaturePath")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$appData")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$signaturePath"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Check signature path, and create if necessary"),"\n",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token operator"},"-not"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token function"},"Test-Path")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Path ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$localSignaturePath"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"New-Item")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$localSignaturePath")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),(0,o.kt)("span",{parentName:"code",className:"token function"},"Type")," Directory\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Logging"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$logPath")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$localSignaturePath")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"\\set_outlook_signature.log"'),"\n",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token operator"},"-not")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token function"},"Test-Path")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$logPath"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-or")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token function"},"Get-Item")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$logPath"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Length ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-gt")," 100kb",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"New-Item")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$logPath")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),(0,o.kt)("span",{parentName:"code",className:"token function"},"type")," file ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"force\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n",(0,o.kt)("span",{parentName:"code",className:"token function"},"Start-Transcript")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"path ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$logPath")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Append\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Get Active Directory information for current user"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$username")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$env"),":username\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$filter")," = ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"(&(objectCategory=User)(samAccountName=',(0,o.kt)("span",{parentName:"span",className:"token variable"},"$username"),'))"'),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$searcher")," = ",(0,o.kt)("span",{parentName:"code",className:"token function"},"New-Object")," System",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"DirectoryServices",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"DirectorySearcher\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$searcher"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,o.kt)("span",{parentName:"code",className:"token keyword"},"Filter")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$filter"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$ADUserPath")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$searcher"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"FindOne",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$ADUser")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$ADUserPath"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"GetDirectoryEntry",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"### Timestamping - lets not run this more than we need to"),"\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Get last run timestamp"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timestampPath")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$localSignaturePath")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"\\set_outlook_signature_timestamp.txt"'),"\n",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token operator"},"-not")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token function"},"Test-Path")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timestampPath"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# If no timestamp is found, the script hasn't run"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# So lets set last run date to the very distant past"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$epoch")," = ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Get-Date")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Year 1970\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"New-Item")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timestampPath")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),(0,o.kt)("span",{parentName:"code",className:"token function"},"type")," file\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Add-Content")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timestampPath")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$epoch"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"ToFileTimeUtc",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timestamp")," = ",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[DateTime]"),"::FromFileTimeUtc",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token function"},"Get-Content")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timestampPath"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$currentTime")," = ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token function"},"Get-Date"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"ToUniversalTime",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Get time since the last run of this script"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timeSinceLastRun")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$currentTime"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Subtract",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timestamp"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timeSinceLastRun"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"TotalDays ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-lt")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_MAX_AGE"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Get time since last user modification"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$userTimestamp")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$ADUser"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"whenChanged",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"["),"0",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"]"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timeSinceLastUserChange")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$userTimestamp"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Subtract",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timestamp"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Get time since last template change"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$composeTimestamp")," = ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token function"},"Get-Item")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_COMPOSE_TEMPLATE"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"LastWriteTimeUtc\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$replyTimestamp")," = ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token function"},"Get-Item")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_REPLY_TEMPLATE"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"LastWriteTimeUtc\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timeSinceLastComposeChange")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$composeTimestamp"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Subtract",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timestamp"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timeSinceLastReplyChange")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$replyTimestamp"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Subtract",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timestamp"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$changeDetected")," = ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Positive seconds means the timestamp is older"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timeSinceLastUserChange"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"TotalSeconds ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-gt")," 0",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"User has been modified, renewing signature"'),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$changeDetected")," = ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$true"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timeSinceLastComposeChange"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"TotalSeconds ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-gt")," 0",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Compose template has been modified, renewing signature"'),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$changeDetected")," = ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$true"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timeSinceLastReplyChange"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"TotalSeconds ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-gt")," 0",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Reply template has been modified, renewing signature"'),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$changeDetected")," = ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$true"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token operator"},"-not")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$changeDetected"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"No changes detected, exiting..."'),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Stop-Transcript"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Copy-Item")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$logPath")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Destination ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$LOG_FOLDER")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_LOG_FOLDER")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"signature-"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$username")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'".log"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"exit"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"else")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Signature is old, lets renew it"'),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Load word.application enums"),"\n",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[System.Reflection.Assembly]"),"::LoadWithPartialName",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token string"},'"Microsoft.Office.Interop.Word"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"|")," ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Out-Null"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Text manipulation settings"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$replaceAll")," = ",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[Enum]"),"::Parse",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[Microsoft.Office.Interop.Word.WdReplace]"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"wdReplaceAll"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$matchCase")," = ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$matchWholeWord")," = ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$true"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$matchWildcards")," = ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$matchSoundsLike")," = ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$matchAllWordForms")," = ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$forward")," = ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$true"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$wrap")," = ",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[Enum]"),"::Parse",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[Microsoft.Office.Interop.Word.WdFindWrap]"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"wdFindContinue"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$format")," = ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$true"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Create instance of Office Word"),"\n",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"try")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$MSWord")," = ",(0,o.kt)("span",{parentName:"code",className:"token function"},"New-Object")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"ComObject word",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"application\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Word version is: "')," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$MSWord"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"BuildFull\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"catch")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$_"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Exception",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Message\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Could not load Word, checking for office install"'),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$comObject")," = ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Get-ChildItem")," HKLM:\\Software\\Classes ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"ea 0 ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"|")," ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Where-Object")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$_"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"PSChildName ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-eq")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},"'Word.Application'")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-and")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token function"},"Get-ItemProperty")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"',(0,o.kt)("span",{parentName:"span",className:"token function"},"$",(0,o.kt)("span",{parentName:"span",className:"token punctuation"},"("),"_",(0,o.kt)("span",{parentName:"span",className:"token punctuation"},"."),"PSPath",(0,o.kt)("span",{parentName:"span",className:"token punctuation"},")")),'\\CLSID"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"ea 0",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$comObject")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-ne")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$null"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token function"},"Test-Path")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"C:\\program files\\Microsoft Office 15\\ClientX86"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Repairing Office 32 bit"'),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# CMD Prompt style command for background office repair"),"\n            & ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"C:\\program files\\Microsoft Office 15\\ClientX86\\OfficeClickToRun.exe"')," scenario=Repair DisplayLevel=False\n        ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"elseif")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token function"},"Test-Path")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"C:\\program files\\Microsoft Office 15\\ClientX64"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Repairing Office 64 bit"'),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# CMD Prompt style command for background office repair"),"\n            & ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"C:\\program files\\Microsoft Office 15\\ClientX64\\OfficeClickToRun.exe"')," scenario=Repair DisplayLevel=False\n        ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"else")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"OfficeClickToRun not found, repair failed"'),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"else")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Word COM object not found, please check office is installed"'),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Finish transcription to log file"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Stop-Transcript"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Send log file to Logs folder"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Copy-Item")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$logPath")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Destination ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$LOG_FOLDER")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_LOG_FOLDER")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"signature-"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$username")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'".log"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"exit"),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Check for pass by reference or not"),"\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# This is a disgusting hack, thanks Microsoft..."),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$isPassByRef")," = ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$true"),"\n",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"try")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$MSWord"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Repeat",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[ref]"),"0",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"catch")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$isPassByRef")," = ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Pass by ref: "')," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$isPassByRef"),"\n\n\n",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"function")," ReplaceText",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$find"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$replace"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$currentDocument"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,o.kt)("span",{parentName:"code",className:"token function"},"Select"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"try")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$isMatched")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$MSWord"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Selection",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Find",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Execute",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$find"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$matchCase"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$matchWholeWord"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$matchWildcards"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$matchSoundsLike"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$matchAllWordForms"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$forward"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$wrap"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$format"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$replace"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$replaceAll"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$isMatched"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$find")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$replace"),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"return")," ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$true"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"catch")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Replace failed for:"')," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$find"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"return")," ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"function")," FindText",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$find"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$currentDocument"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,o.kt)("span",{parentName:"code",className:"token function"},"Select"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$MSWord"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Selection",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Find",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Execute",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$find"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$matchCase"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$matchWholeWord"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$matchWildcards"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$matchSoundsLike"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$matchAllWordForms"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$forward"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$wrap"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$format"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"return")," ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$true"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"return")," ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"function")," RemoveText",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$text"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ReplaceText ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$text")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'""'),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"function")," SetSignature",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$aTemplateFile"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$aTemplateName"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Copying Signature file: ',(0,o.kt)("span",{parentName:"span",className:"token variable"},"$aTemplateFile"),'"'),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"try")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Copy-Item")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$aTemplateFile")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$localSignaturePath")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Recurse ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Force\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"catch")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Couldn\'t load template, error: "')," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$_"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Exception",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Message\n        ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"return")," ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Insert variables from Active Directory into file"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$fullPath")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$localSignaturePath")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"\\"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$aTemplateFile"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$currentDocument")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$MSWord"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Documents",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Open",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$fullPath"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"#filename, show convert file, open read-only, add to recent files"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Setting signature values for ',(0,o.kt)("span",{parentName:"span",className:"token variable"},"$aTemplateName"),'"'),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"foreach")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$property")," in ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$ADUser"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"psobject",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"properties",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$propertyName")," = ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"["')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$property"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"name ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"]"'),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$property"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"value ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-ne")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$null"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ReplaceText ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$propertyName")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$property"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"value",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"toString",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," > ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$null"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Set mail hyperlink"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"foreach")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$hyperlink")," in ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$MSWord"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"ActiveDocument",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Hyperlinks",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$hyperlink"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Name ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-eq")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"mailto:[mail]"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$mailtoLink")," = ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"mailto:"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$ADUser"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"mail\n            ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$hyperlink"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Address = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$mailtoLink"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Remove empty lines if necessary"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Removing empty template lines"'),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"foreach")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$line")," in ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_TEMPLATE_BLANKS"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        RemoveText ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$line")," > ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$null"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# If any blanks failed to be removed, don't save"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),"FindText ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"["'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Blank template lines found, saving failed, Please check Powershell-Vars.ps1 string removal array"'),"\n\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$currentDocument"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Close",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"return")," ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Save new message signature"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Saving signature ',(0,o.kt)("span",{parentName:"span",className:"token variable"},"$aTemplateName"),'"'),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Save HTML"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$saveFormat")," = ",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[Enum]"),"::Parse",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[Microsoft.Office.Interop.Word.WdSaveFormat]"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"wdFormatHTML"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$path")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$localSignaturePath")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"\\"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$aTemplateName")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'".htm"'),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"try")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"#filename, file format, lock comments, password, add to recent files"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$isPassByRef"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$currentDocument"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"SaveAs",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[ref]"),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$path"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[ref]"),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$saveFormat"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[ref]"),(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[ref]"),(0,o.kt)("span",{parentName:"code",className:"token string"},'""'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[ref]"),(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"else")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$currentDocument"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"SaveAs",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$path"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$saveFormat"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'""'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"catch")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Failed to save as HTML, error: "')," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$_"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Exception",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Message\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$currentDocument"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Close",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"return")," ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Save RTF"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$saveFormat")," = ",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[Enum]"),"::Parse",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[Microsoft.Office.Interop.Word.WdSaveFormat]"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"wdFormatRTF"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$path")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$localSignaturePath")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"\\"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$aTemplateName")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'".rtf"'),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"try")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$isPassByRef"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$currentDocument"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"SaveAs",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[ref]"),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$path"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[ref]"),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$saveFormat"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[ref]"),(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[ref]"),(0,o.kt)("span",{parentName:"code",className:"token string"},'""'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[ref]"),(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"else")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$currentDocument"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"SaveAs",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$path"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$saveFormat"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'""'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"catch")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Failed to save as RTF, error: "')," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$_"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Exception",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Message\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$currentDocument"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Close",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"return")," ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Save TXT"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$saveFormat")," = ",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[Enum]"),"::Parse",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[Microsoft.Office.Interop.Word.WdSaveFormat]"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"wdFormatText"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$path")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$localSignaturePath")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"\\"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$aTemplateName")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'".txt"'),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"try")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$isPassByRef"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$currentDocument"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"SaveAs",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[ref]"),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$path"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[ref]"),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$saveFormat"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[ref]"),(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[ref]"),(0,o.kt)("span",{parentName:"code",className:"token string"},'""'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[ref]"),(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"else")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$currentDocument"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"SaveAs",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$path"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$saveFormat"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'""'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"catch")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Failed to save as TXT, error: "')," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$_"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Exception",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Message\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$currentDocument"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Close",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"return")," ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$false"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$currentDocument"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Close",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"return")," ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$true"),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"function")," ExitGracefully",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$saveOptions")," = ",(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[Enum]"),"::Parse",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[Microsoft.Office.Interop.Word.WdSaveOptions]"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},","),"  ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"wdDoNotSaveChanges"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$isPassByRef"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$MSWord"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Quit",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token namespace"},"[ref]"),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$saveOptions"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"else")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$MSWord"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Quit",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$saveOptions"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Finish transcription to log file"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Stop-Transcript"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Send log file to Logs folder"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Copy-Item")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$logPath")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Destination ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$LOG_FOLDER")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_LOG_FOLDER")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"signature-"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$username")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'".log"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Waiting 2 seconds for AD object"'),"\n",(0,o.kt)("span",{parentName:"code",className:"token function"},"Start-Sleep")," 2\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Run signature filler"),"\n",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token operator"},"-not")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),"SetSignature ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_COMPOSE_TEMPLATE")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_COMPOSE_NAME"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Compose Template creation failed, exiting"'),"\n    ExitGracefully\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"exit"),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_SEPARATE"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token operator"},"-not")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),"SetSignature ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_REPLY_TEMPLATE")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_REPLY_NAME"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Reply Template creation failed, exiting"'),"\n        ExitGracefully\n        ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"exit"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# All Office versions"),"\n",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Adding signature to Office"'),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$emailOptions")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$MSWord"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"EmailOptions\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$emailSignature")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$emailOptions"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"EmailSignature\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$emailCompose")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$emailOptions"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"ComposeStyle\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$emailReply")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$emailOptions"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"ReplyStyle\n\n",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"try")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$emailSignature"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"NewMessageSignature = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_COMPOSE_NAME"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$emailSignature"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"ReplyMessageSignature = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_REPLY_NAME"),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"catch")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Setting default signature failed, exiting"'),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$_"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Exception",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Message\n    ExitGracefully\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n\n",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_FORCE"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Office 2010"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"If")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token function"},"Test-Path")," HKCU:Software\\Microsoft\\Office\\14",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"0",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Forcing set signature for Outlook 2010"'),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"New-ItemProperty")," HKCU:",(0,o.kt)("span",{parentName:"code",className:"token string"},"'\\Software\\Microsoft\\Office\\14.0\\Common\\MailSettings'")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Name ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"ReplySignature"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Value ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_REPLY_NAME")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"PropertyType ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"String"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Force\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"New-ItemProperty")," HKCU:",(0,o.kt)("span",{parentName:"code",className:"token string"},"'\\Software\\Microsoft\\Office\\14.0\\Common\\MailSettings'")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Name ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"NewSignature"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Value ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_COMPOSE_NAME")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"PropertyType ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"String"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Force\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"else")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Office 2010 not installed, 2010 signatures skipped"'),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Office 2013"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token function"},"Test-Path")," HKCU:Software\\Microsoft\\Office\\15",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"0",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Forcing set signature for Outlook 2013"'),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"New-ItemProperty")," HKCU:",(0,o.kt)("span",{parentName:"code",className:"token string"},"'\\Software\\Microsoft\\Office\\15.0\\Common\\MailSettings'")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Name ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"ReplySignature"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Value ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_REPLY_NAME")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"PropertyType ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"String"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Force\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"New-ItemProperty")," HKCU:",(0,o.kt)("span",{parentName:"code",className:"token string"},"'\\Software\\Microsoft\\Office\\15.0\\Common\\MailSettings'")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Name ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"NewSignature"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Value ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_COMPOSE_NAME")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"PropertyType ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"String"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Force\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"else")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Office 2013 not installed, 2013 signatures skipped"'),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"else")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Office 2010"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"If")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token function"},"Test-RegistryValue")," HKCU:",(0,o.kt)("span",{parentName:"code",className:"token string"},"'\\Software\\Microsoft\\Office\\14.0\\Common\\MailSettings'")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"NewSignature"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Removing signature enforcement for Outlook 2010"'),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Remove-ItemProperty")," HKCU:",(0,o.kt)("span",{parentName:"code",className:"token string"},"'\\Software\\Microsoft\\Office\\14.0\\Common\\MailSettings'")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Name ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"ReplySignature"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Force\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Remove-ItemProperty")," HKCU:",(0,o.kt)("span",{parentName:"code",className:"token string"},"'\\Software\\Microsoft\\Office\\14.0\\Common\\MailSettings'")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Name ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"NewSignature"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Force\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Office 2013"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token function"},"Test-RegistryValue")," HKCU:",(0,o.kt)("span",{parentName:"code",className:"token string"},"'\\Software\\Microsoft\\Office\\15.0\\Common\\MailSettings'")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"NewSignature"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Removing signature enforcement for Outlook 2013"'),"\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Remove-ItemProperty")," HKCU:",(0,o.kt)("span",{parentName:"code",className:"token string"},"'\\Software\\Microsoft\\Office\\15.0\\Common\\MailSettings'")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Name ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"ReplySignature"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Force\n        ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Remove-ItemProperty")," HKCU:",(0,o.kt)("span",{parentName:"code",className:"token string"},"'\\Software\\Microsoft\\Office\\15.0\\Common\\MailSettings'")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Name ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"NewSignature"')," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Force\n    ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_FORCE_THEME"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Themes are enforced, setting font for compose and reply"'),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$emailCompose"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Font",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Name = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_COMPOSE_FONT"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$emailCompose"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Font",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Size = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_COMPOSE_SIZE"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$emailCompose"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Font",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Color = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_COMPOSE_COLOR"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$emailReply"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Font",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Name = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_REPLY_FONT"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$emailReply"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Font",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Size = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_REPLY_SIZE"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$emailReply"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Font",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Color = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_REPLY_COLOR"),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Ensure no custom themes are used"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$emailOptions"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"ThemeName = ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"none"'),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"if")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$SIGNATURE_MARK_COMMENTS"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Write-Host")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Email comments are marked, setting mark as user initials"'),"\n\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$emailOptions"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"MarkCommentsWith = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$MSWord"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"UserInitials\n    ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$emailOptions"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"MarkComments = ",(0,o.kt)("span",{parentName:"code",className:"token boolean"},"$true"),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Timestamp the last run time"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$newTime")," = ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token function"},"Get-Date"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"ToFileTimeUtc",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,o.kt)("span",{parentName:"code",className:"token function"},"New-Item")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timestampPath")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),(0,o.kt)("span",{parentName:"code",className:"token function"},"type")," file ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"force\n",(0,o.kt)("span",{parentName:"code",className:"token function"},"Add-Content")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$timestampPath")," ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$newTime"),"\n\nExitGracefully"))))}m.isMDXComponent=!0;var r=["components"],k={_frontmatter:{}};function N(e){var a=e.components,n=(0,s.Z)(e,r);return(0,o.kt)("wrapper",Object.assign({},k,n,{components:a,mdxType:"MDXLayout"}),(0,o.kt)("h2",null,"Repair Sharepoint apps after theme change"),(0,o.kt)("p",null,"On SharePoint, if you change the theme of an App on the App Catalog, or change a theme of a site that contains an Apps, all the Apps in the App Catalog will fail catastrophically."),(0,o.kt)("p",null,"This script is a quick fixme that requires zero configuration, just upload it to the SharePoint server and run it to repair the App Catalog entirely."),(0,o.kt)("div",{className:"gatsby-highlight","data-language":"powershell"},(0,o.kt)("pre",{parentName:"div",className:"language-powershell"},(0,o.kt)("code",{parentName:"pre",className:"language-powershell"},(0,o.kt)("span",{parentName:"code",className:"token comment"},"#!/usr/local/bin/pwsh"),"\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Written by George Paton"),"\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"## This little number automatically fixes that annoying app breaking bug to do with themes"),"\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"## If an app is complaining about being unable to open a file, run me on the SP server"),"\n\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Add the sharepoint snapin to the current session"),"\n",(0,o.kt)("span",{parentName:"code",className:"token function"},"Add-PSSnapin")," Microsoft",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Sharepoint",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Powershell\n\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Get the app prefix"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$prefix")," = ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Get-SPAppSiteSubscriptionName"),"\n",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Use the app prefix to get all app urls"),"\n",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$allappurls")," = ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Get-SPSite")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"|")," ",(0,o.kt)("span",{parentName:"code",className:"token function"},"Get-SPWeb")," ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-"),"Limit All ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"|")," where ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$_"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"url ",(0,o.kt)("span",{parentName:"code",className:"token operator"},"-like")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"http://',(0,o.kt)("span",{parentName:"span",className:"token variable"},"$prefix"),'*"'),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,o.kt)("span",{parentName:"code",className:"token keyword"},"foreach")," ",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token variable"},"$app")," in ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$allappurls"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token comment"},"# Loop through all apps within the default site with the app prefix of $prefix"),"\n\t",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$name")," = ",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$app"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"name\n\t",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$app"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"CustomMasterUrl = ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"/',(0,o.kt)("span",{parentName:"span",className:"token variable"},"$name"),'/_catalogs/masterpage/app.master"'),"\n\t",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$app"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"MasterUrl = ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"/',(0,o.kt)("span",{parentName:"span",className:"token variable"},"$name"),'/_catalogs/masterpage/app.master"'),"\n\t",(0,o.kt)("span",{parentName:"code",className:"token variable"},"$app"),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"."),"Update",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,o.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,o.kt)("span",{parentName:"code",className:"token function"},"echo")," ",(0,o.kt)("span",{parentName:"code",className:"token string"},'"Updating masterpage for ',(0,o.kt)("span",{parentName:"span",className:"token variable"},"$app"),'"'),"\n",(0,o.kt)("span",{parentName:"code",className:"token punctuation"},"}")))))}N.isMDXComponent=!0;var l=n(9472),i=function(){return t.createElement("main",{className:"container"},t.createElement("div",{className:"block-center"},t.createElement("h1",null,"Useful Powershell scripts")),t.createElement("h3",null,"Table of contents"),t.createElement("ul",null,t.createElement("li",null,t.createElement("a",{href:"#outlook-signatures"},"Autogenerate Outlook signatures")),t.createElement("li",null,t.createElement("a",{href:"#fix-sharepoint"},"Repair Sharepoint apps after theme change"))),t.createElement("br",null),t.createElement("div",{id:"outlook-signatures"},t.createElement(m,null),t.createElement("hr",null)),t.createElement("div",{id:"fix-sharepoint"},t.createElement(N,null),t.createElement("br",null)),t.createElement("div",{className:"block-center"},t.createElement("a",{href:"/"},"Go home")),t.createElement("br",null),t.createElement(l.Z,null))}},3366:function(e,a,n){function t(e,a){if(null==e)return{};var n,t,s={},o=Object.keys(e);for(t=0;t<o.length;t++)n=o[t],a.indexOf(n)>=0||(s[n]=e[n]);return s}n.d(a,{Z:function(){return t}})}}]);
//# sourceMappingURL=component---src-pages-powershell-tsx-85175ab790bd8d677b7a.js.map